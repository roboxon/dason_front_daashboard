name: Deploy to Remote Server

on:
  push:
    branches:
      - deploy

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Set Up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18

      - name: Install Dependencies
        run: |
          npm install

      - name: Build Next.js App
        run: |
          npm run build

      - name: Deploy to Remote Server via SFTP
        uses: SamKirkland/FTP-Deploy-Action@4.3.3
        with:
          server: ${{ secrets.SFTP_SERVER_NEXT }}
          username: ${{ secrets.SFTP_USERNAME_NEXT }}
          password: ${{ secrets.SFTP_PASSWORD_NEXT }}
          protocol: ftps
          localPath: .next
          exclude: .git/**/*
          port: 21
